{% extends 'cuisine/base.html' %}
{% load static %}

{% block content %}
<div class="max-w-5xl mx-auto px-6 py-16">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-16 items-start">
        
        <div class="bg-gray-50 rounded-sm overflow-hidden shadow-sm border border-gray-100">
             <img src="{% static 'cuisine/image.jpg' %}" alt="Gina Cuisine" class="w-full h-auto object-cover">
        </div>

        <div>
             <h1 class="font-serif italic text-3xl md:text-5xl text-gray-800 mb-8">Laissez-moi un message</h1>
            <p class="text-gray-500 italic text-lg mb-8">
                Vous voulez papoter un peu avec moi ou me poser une question ? 
                Laissez-moi un message et je vous répondrai au plus vite...
           </p>

          <form id="my-form" action="https://formspree.io/f/xzdapgqp" method="POST" class="space-y-8">
    {% csrf_token %}
    
    <div id="success-message" class="hidden bg-amber-50 border border-amber-200 p-6 text-center mb-8">
        <i class="fa-regular fa-circle-check text-3xl text-amber-600 mb-2"></i>
        <p id="thank-you-text" class="text-gray-800 font-medium"></p>
    </div>

    <div>
        <label class="block text-sm font-bold uppercase tracking-widest text-gray-900 mb-3">Votre nom complet</label>
        <input type="text" name="name" id="full-name" placeholder="Ex: Jean Dupont" required
               class="w-full px-4 py-3 border-2 border-gray-900 rounded-none focus:border-amber-600 outline-none transition-all placeholder:text-gray-300">
    </div>

    <div>
        <label class="block text-sm font-bold uppercase tracking-widest text-gray-900 mb-3">Votre adresse email</label>
        <input type="email" name="email" placeholder="exemple@mail.com" required
               class="w-full px-4 py-3 border-2 border-gray-900 rounded-none focus:border-amber-600 outline-none transition-all placeholder:text-gray-300">
    </div>

    <div>
        <label class="block text-sm font-bold uppercase tracking-widest text-gray-900 mb-3">Votre message</label>
        <textarea name="message" rows="5" placeholder="Comment puis-je vous aider ?" required
                  class="w-full px-4 py-3 border-2 border-gray-900 rounded-none focus:border-amber-600 outline-none transition-all placeholder:text-gray-300"></textarea>
    </div>

    <button type="submit" id="submit-btn"
            class="w-full bg-gray-900 text-white py-4 font-bold uppercase tracking-[0.2em] text-[12px] hover:bg-amber-700 transition-colors duration-300">
        Envoyer le message
    </button>
</form>
        </div>
    </div>
</div>



<script>
  var form = document.getElementById("my-form");
  
  async function handleSubmit(event) {
    event.preventDefault(); // Empêche la redirection vers Formspree
    
    var status = document.getElementById("success-message");
    var textSpan = document.getElementById("thank-you-text");
    var button = document.getElementById("submit-btn");
    var data = new FormData(event.target);
    
    // Récupère le nom saisi
    var nomComplet = document.getElementById("full-name").value;

    // Change le texte du bouton pendant l'envoi
    button.innerHTML = "ENVOI EN COURS...";
    button.disabled = true;

    fetch(event.target.action, {
      method: form.method,
      body: data,
      headers: {
          'Accept': 'application/json'
      }
    }).then(response => {
      if (response.ok) {
        // Affiche le message de réussite dans la page
        textSpan.innerHTML = "Merci " + nomComplet + ", votre message a été envoyé avec succès !";
        status.classList.remove("hidden"); // Affiche le bloc de succès
        form.reset(); // Vide le formulaire
        button.innerHTML = "MESSAGE ENVOYÉ !";
      } else {
        button.innerHTML = "ERREUR";
        button.disabled = false;
        alert("Oups ! Il y a eu un problème lors de l'envoi.");
      }
    }).catch(error => {
      button.innerHTML = "ERREUR RÉSEAU";
      button.disabled = false;
      alert("Erreur de connexion.");
    });
  }
  
  form.addEventListener("submit", handleSubmit);
</script>


{% endblock %}